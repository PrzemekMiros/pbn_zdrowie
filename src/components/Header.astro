---
import logo from "../assets/images/global/logo.png";
const { settings } = Astro.props;
const pathname = Astro.url?.pathname ?? "";
const isActive = (href) =>
	href === "/" ? pathname === "/" : pathname.startsWith(href);
const navItems = [
	{ href: "/realizacje/", label: "Realizacje" },
    { href: "/opinie/", label: "Opinie" },
    { href: "/faq/", label: "Faq" },
	{ href: "/artykuly/", label: "Poradnik" },
	{ href: "/kontakt/", label: "Kontakt" },
];
const linkClass = (href) =>
	isActive(href)
		? "px-3 py-3 text-white no-underline transition hover:brightness-95"
		: "px-3 py-3 text-white/70 no-underline transition hover:text-white";
const mobileLinkClass = (href) =>
	isActive(href)
		? "text-xl px-5 py-4 text-base font-semibold"
		: "text-xl bg-white px-5 py-4 text-base font-semibold text-black/80 hover:bg-black/5";
---

<header class="fixed left-0 right-0 top-0 z-500 border-b border-white/15 bg-black/90 py-5 sm:py-4.5 backdrop-blur-md">
    <div class="mx-auto w-full max-w-[1240px] px-4 sm:px-10 md:px-10 xl:px-0">
        <nav class="flex items-center justify-between gap-4">
            <a href="/" class="text-xl font-bold tracking-tighter text-white no-underline" aria-label="Logo">
              <img src={logo.src} class="w-42" width="280" height="66" alt="Logo Przemek Miros">
            </a>

            <div class="hidden items-center justify-center gap-8 text-sm font-medium md:flex">
                {
                    navItems.map((item) => (
                        <a
                            class={`${linkClass(item.href)} transition-colors hover:text-white`}
                            href={item.href}
                            aria-current={isActive(item.href) ? "page" : undefined}
                        >
                            {item.label}
                        </a>
                    ))
                }
            </div>

            <a
                class="hidden items-center rounded-full bg-[var(--accent)] px-5 py-3 text-sm font-semibold text-white transition hover:bg-orange-700 hover:text-white md:inline-flex"
                href="/kontakt/"
            >
                Wycena
            </a>

            <button
                class="inline-flex items-center justify-center rounded-full border border-white/10 bg-white/5 px-4 py-2 text-[10px] font-bold uppercase tracking-[0.2em] text-white transition hover:bg-white/10 md:hidden"
                type="button"
                data-mobile-toggle
            >
                Menu
            </button>
        </nav>

        <div
            class="fixed inset-x-0 top-0 z-[60] h-screen flex flex-col gap-6 overflow-hidden bg-[#0a0a0a] p-8 text-white transition-all duration-300 pointer-events-none opacity-0 md:hidden"
            id="mobile-menu"
            data-mobile-menu
        >
            <div class="flex items-center justify-between">
                <span class="text-xs font-bold uppercase tracking-widest text-gray-500">Nawigacja</span>
                <button
                    class="text-[10px] font-bold uppercase tracking-widest text-orange-500"
                    type="button"
                    data-mobile-close
                >
                    Zamknij
                </button>
            </div>

            <div class="flex flex-col gap-6 pt-12">
                {
                    navItems.map((item) => (
                        <a
                            class="text-xl font-semibold tracking-tight text-white no-underline"
                            href={item.href}
                            data-mobile-link
                        >
                            {item.label}
                        </a>
						<div class="border border-b border-white/10"></div>
                    ))
                }
            </div>

        </div>
    </div>
</header>

<style>
    /* Klasa pomocnicza dla otwartego menu */
    #mobile-menu.is-open {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
    }
</style>

<script>
    document.addEventListener('astro:page-load', () => {
        const toggle = document.querySelector("[data-mobile-toggle]");
        const menu = document.querySelector("[data-mobile-menu]");
        const closeBtn = document.querySelector("[data-mobile-close]");
        const links = document.querySelectorAll("[data-mobile-link]");

        if (toggle && menu) {
            const setOpen = (isOpen) => {
                menu.classList.toggle("is-open", isOpen);
                document.body.style.overflow = isOpen ? "hidden" : "";
            };

            toggle.addEventListener("click", () => setOpen(true));
            closeBtn?.addEventListener("click", () => setOpen(false));
            
            /*
            // Zamknij po klikniÄ™ciu w link
            links.forEach(link => {
                link.addEventListener("click", () => setOpen(false));
            });
            */
        }
    });
</script>
