---
import logo from "../assets/images/global/logo.png";
import Search from "astro-pagefind/components/Search";
const { settings } = Astro.props;
const pathname = Astro.url?.pathname ?? "";
const isActive = (href) =>
	href === "/" ? pathname === "/" : pathname.startsWith(href);
const navItems = [
	{ href: "/psychosomatyka/", label: "Psychosomatyka" },
    { href: "/problemy-trawienne/", label: "Trawienie" },
    { href: "/uklad-nerwowy/", label: "Układ nerwowy" },
    { href: "/sen-i-regenercja/", label: "Sen i regeneracja" },
    { href: "/hormony/", label: "Hormony" },
    { href: "/bole-ciala/", label: "Bóle ciała" },
    { href: "/odpornosc/", label: "Odporność" },
	{ href: "/artykuly/", label: "Artykuły" },
];
const linkClass = (href) =>
	isActive(href)
		? "px-3 py-2 text-black no-underline transition"
		: "px-3 py-2 text-black/70 no-underline transition hover:text-black";
---

<header class="fixed left-0 right-0 top-0 z-500 bg-black/05 pt-3 backdrop-blur-md">
    <div class="mx-auto w-full max-w-[1240px]">
        <div class="grid grid-cols-3 gap-4 space-between items-center pb-3">
            <div>
                <a href="/" class="text-xl font-bold tracking-tighter text-black no-underline" aria-label="Logo">
                    <img src={logo.src} class="w-38" width="280" height="66" alt="Logo Zdrowie bez paniki">
                </a>
            </div>
            <div class="hidden md:flex items-center justify-center">
                <div class="w-full max-w-[420px]">
                    <Search
                        id="site-search"
                        className="pagefind-ui pagefind-ui--header"
                        uiOptions={{ showImages: false, showDates: true, showCategories: true }}
                    />
                </div>
            </div>
            <div class="flex justify-end">
              O
            </div>
        </div>

        <nav class="flex items-center justify-between gap-4 border-y border-black/20">
            <div class="hidden items-center justify-center gap-8 text-sm font-medium md:flex">
                {
                    navItems.map((item) => (
                        <a
                            class={`${linkClass(item.href)} transition-colors hover:text-black`}
                            href={item.href}
                            aria-current={isActive(item.href) ? "page" : undefined}
                        >
                            {item.label}
                        </a>
                    ))
                }
            </div>

            <button
                class="inline-flex items-center justify-center rounded-full border border-white/10 bg-white/5 px-4 py-2 text-[10px] font-bold uppercase tracking-[0.2em] text-black transition hover:bg-white/10 md:hidden"
                type="button"
                data-mobile-toggle
            >
                Menu
            </button>
        </nav>

        <div
            class="fixed inset-x-0 top-0 z-[60] h-screen flex flex-col gap-6 overflow-hidden bg-[#0a0a0a] p-8 text-white transition-all duration-300 pointer-events-none opacity-0 md:hidden"
            id="mobile-menu"
            data-mobile-menu
        >
            <div class="flex items-center justify-between">
                <span class="text-xs font-bold uppercase tracking-widest text-gray-500">Nawigacja</span>
                <button
                    class="text-[10px] font-bold uppercase tracking-widest text-orange-500"
                    type="button"
                    data-mobile-close
                >
                    Zamknij
                </button>
            </div>

            <div class="flex flex-col gap-6 pt-12">
                {
                    navItems.map((item) => (
                        <a
                            class="text-xl font-semibold tracking-tight text-white no-underline"
                            href={item.href}
                            data-mobile-link
                        >
                            {item.label}
                        </a>
						<div class="border border-b border-white/10"></div>
                    ))
                }
            </div>

        </div>
    </div>
</header>

<style>
    /* Klasa pomocnicza dla otwartego menu */
    #mobile-menu.is-open {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
    }
</style>

<script>
    document.addEventListener('astro:page-load', () => {
        const toggle = document.querySelector("[data-mobile-toggle]");
        const menu = document.querySelector("[data-mobile-menu]");
        const closeBtn = document.querySelector("[data-mobile-close]");
        const links = document.querySelectorAll("[data-mobile-link]");

        if (toggle && menu) {
            const setOpen = (isOpen) => {
                menu.classList.toggle("is-open", isOpen);
                document.body.style.overflow = isOpen ? "hidden" : "";
            };

            toggle.addEventListener("click", () => setOpen(true));
            closeBtn?.addEventListener("click", () => setOpen(false));
            
            /*
            // Zamknij po kliknięciu w link
            links.forEach(link => {
                link.addEventListener("click", () => setOpen(false));
            });
            */
        }
    });
</script>
