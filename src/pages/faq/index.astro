---
import BaseLayout from "../../layouts/BaseLayout.astro";

const entries = import.meta.glob("../../content/faq/*.md", { eager: true });
const questions = Object.entries(entries)
  .map(([file, entry]) => {
    const slug = file.split("/").pop().replace(".md", "");
    return { slug, ...entry.frontmatter };
  })
  .sort((a, b) => (a.title ?? "").localeCompare(b.title ?? "", "pl", { sensitivity: "base" }));
---

<BaseLayout
  title="Zadawane pytania"
  description="Napisz lub zadzwon, opowiedz o projekcie i otrzymaj odpowiedz w 24-48h."
>
  <section class="relative pb-16 pt-16" itemscope itemtype="https://schema.org/FAQPage">
    <div class="grid gap-4 md:grid-cols-2">
      {questions.map((item) => {
        const hasAnswer = typeof item.answer === "string" && item.answer.trim().length > 0;
        return (
          <article
            class="rounded-xl border border-black/20 bg-white px-4 py-8 md:px-6 transition hover:border-[var(--accent)] hover:shadow-lg"
            {...(hasAnswer
              ? {
                  itemscope: true,
                  itemtype: "https://schema.org/Question",
                  itemprop: "mainEntity",
                }
              : {})}
          >
            <h2 class="text-xl font-semibold text-[var(--text)]" {...(hasAnswer ? { itemprop: "name" } : {})}>
              {item.title}
            </h2>
            {hasAnswer ? (
              <div itemprop="acceptedAnswer" itemscope itemtype="https://schema.org/Answer">
                <p class="mt-3 leading-relaxed text-[var(--muted)]" itemprop="text">
                  {item.answer}
                </p>
              </div>
            ) : item.answer ? (
              <p class="mt-3 leading-relaxed text-[var(--muted)]">{item.answer}</p>
            ) : null}
          </article>
        );
      })}
    </div>
  </section>
</BaseLayout>
